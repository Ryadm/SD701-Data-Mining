{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# SD701 Lab session: classification and clustering\n",
    "\n",
    "The goal of this lab session is for you to get a good grasp of data cleaning, clustering, classification implementations and evaluations. For this reason, the lab is less focused on re-implementing existing algorithms, and more onto using what is already available and making sense of it.\n",
    "\n",
    "Let us make our imports."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "metadata": {},
   "outputs": [],
   "source": [
    "import sklearn as sk\n",
    "import numpy as np\n",
    "from sklearn import cluster\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## The Palmer Penguin dataset\n",
    "\n",
    "Let us look at the [Palmer penguins]() dataset. It is a small dataset that contains measurements about real-world penguins.\n",
    "\n",
    "Our task is to:\n",
    "\n",
    "   - Do an exploratory analysis of the data\n",
    "   - Think about what algorithms and features we want to use, and how we need to transform our variables\n",
    "   - Run our algorithms and evaluate them"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "metadata": {},
   "outputs": [],
   "source": [
    "penguins_cs = pd.read_csv(open(\"data/penguins_size.csv\"))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Exploratory analysis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>species</th>\n",
       "      <th>island</th>\n",
       "      <th>culmen_length_mm</th>\n",
       "      <th>culmen_depth_mm</th>\n",
       "      <th>flipper_length_mm</th>\n",
       "      <th>body_mass_g</th>\n",
       "      <th>sex</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>Adelie</td>\n",
       "      <td>Torgersen</td>\n",
       "      <td>39.1</td>\n",
       "      <td>18.7</td>\n",
       "      <td>181.0</td>\n",
       "      <td>3750.0</td>\n",
       "      <td>MALE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>Adelie</td>\n",
       "      <td>Torgersen</td>\n",
       "      <td>39.5</td>\n",
       "      <td>17.4</td>\n",
       "      <td>186.0</td>\n",
       "      <td>3800.0</td>\n",
       "      <td>FEMALE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>Adelie</td>\n",
       "      <td>Torgersen</td>\n",
       "      <td>40.3</td>\n",
       "      <td>18.0</td>\n",
       "      <td>195.0</td>\n",
       "      <td>3250.0</td>\n",
       "      <td>FEMALE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>Adelie</td>\n",
       "      <td>Torgersen</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>Adelie</td>\n",
       "      <td>Torgersen</td>\n",
       "      <td>36.7</td>\n",
       "      <td>19.3</td>\n",
       "      <td>193.0</td>\n",
       "      <td>3450.0</td>\n",
       "      <td>FEMALE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>339</th>\n",
       "      <td>Gentoo</td>\n",
       "      <td>Biscoe</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>340</th>\n",
       "      <td>Gentoo</td>\n",
       "      <td>Biscoe</td>\n",
       "      <td>46.8</td>\n",
       "      <td>14.3</td>\n",
       "      <td>215.0</td>\n",
       "      <td>4850.0</td>\n",
       "      <td>FEMALE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>341</th>\n",
       "      <td>Gentoo</td>\n",
       "      <td>Biscoe</td>\n",
       "      <td>50.4</td>\n",
       "      <td>15.7</td>\n",
       "      <td>222.0</td>\n",
       "      <td>5750.0</td>\n",
       "      <td>MALE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>342</th>\n",
       "      <td>Gentoo</td>\n",
       "      <td>Biscoe</td>\n",
       "      <td>45.2</td>\n",
       "      <td>14.8</td>\n",
       "      <td>212.0</td>\n",
       "      <td>5200.0</td>\n",
       "      <td>FEMALE</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>343</th>\n",
       "      <td>Gentoo</td>\n",
       "      <td>Biscoe</td>\n",
       "      <td>49.9</td>\n",
       "      <td>16.1</td>\n",
       "      <td>213.0</td>\n",
       "      <td>5400.0</td>\n",
       "      <td>MALE</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>344 rows Ã— 7 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    species     island  culmen_length_mm  culmen_depth_mm  flipper_length_mm  \\\n",
       "0    Adelie  Torgersen              39.1             18.7              181.0   \n",
       "1    Adelie  Torgersen              39.5             17.4              186.0   \n",
       "2    Adelie  Torgersen              40.3             18.0              195.0   \n",
       "3    Adelie  Torgersen               NaN              NaN                NaN   \n",
       "4    Adelie  Torgersen              36.7             19.3              193.0   \n",
       "..      ...        ...               ...              ...                ...   \n",
       "339  Gentoo     Biscoe               NaN              NaN                NaN   \n",
       "340  Gentoo     Biscoe              46.8             14.3              215.0   \n",
       "341  Gentoo     Biscoe              50.4             15.7              222.0   \n",
       "342  Gentoo     Biscoe              45.2             14.8              212.0   \n",
       "343  Gentoo     Biscoe              49.9             16.1              213.0   \n",
       "\n",
       "     body_mass_g     sex  \n",
       "0         3750.0    MALE  \n",
       "1         3800.0  FEMALE  \n",
       "2         3250.0  FEMALE  \n",
       "3            NaN     NaN  \n",
       "4         3450.0  FEMALE  \n",
       "..           ...     ...  \n",
       "339          NaN     NaN  \n",
       "340       4850.0  FEMALE  \n",
       "341       5750.0    MALE  \n",
       "342       5200.0  FEMALE  \n",
       "343       5400.0    MALE  \n",
       "\n",
       "[344 rows x 7 columns]"
      ]
     },
     "execution_count": 113,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "penguins_cs"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['species', 'island', 'culmen_length_mm', 'culmen_depth_mm',\n",
       "       'flipper_length_mm', 'body_mass_g', 'sex'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 114,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "penguins_cs.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 224,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[<matplotlib.lines.Line2D at 0x7f88a730bf70>]"
      ]
     },
     "execution_count": 224,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "x = []\n",
    "y = []\n",
    "plt.plot(x, y, 'o')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.axes._subplots.AxesSubplot at 0x7f88b19a4610>"
      ]
     },
     "execution_count": 116,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "penguins_cs['culmen_length_mm'].hist()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Learning on our dataset\n",
    "\n",
    "#### Clustering\n",
    "\n",
    "As you can see, this data is not readily adapted for clustering: many of the variables are non-numerical. We could try different strategies:\n",
    "\n",
    "   - Getting rid of all non numerical variables\n",
    "   - Converting categorical variables to a [one-hot vector](https://en.wikipedia.org/wiki/One-hot) to use them\n",
    "   \n",
    "We will try both approaches. Below is the code for the first approach, the second is yours to write. You can also update the first approach to fill n/a values with something better than $0$."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "metadata": {},
   "outputs": [],
   "source": [
    "penguins_num = penguins_cs[['culmen_length_mm', 'culmen_depth_mm',\n",
    "       'flipper_length_mm', 'body_mass_g']]\n",
    "penguins_num = penguins_num.fillna(0)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### $k$-means\n",
    "\n",
    "Let us focus on the $k$-means clustering algorithm. Once trained, the labels (_i.e._ the cluster assignation) is in `kmeans_algo.labels_`, and the centroids are in `kmeans_algo.cluster_centers_`."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "metadata": {},
   "outputs": [],
   "source": [
    "kmeans_algo = cluster.KMeans(n_clusters=3)\n",
    "kmeans_results = kmeans_algo.fit_transform(penguins_num)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 132,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([[  40.4337931 ,   17.69241379,  186.7862069 , 3407.93103448],\n",
       "       [  48.61111111,   15.40123457,  219.95061728, 5359.87654321],\n",
       "       [  44.24491525,   17.39661017,  201.80508475, 4311.01694915]])"
      ]
     },
     "execution_count": 132,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kmeans_algo.cluster_centers_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 223,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([6, 6, 1, 3, 1, 6, 6, 0, 1, 5, 1, 6, 1, 6, 5, 6, 1, 5, 1, 4, 1, 6,\n",
       "       6, 4, 6, 6, 6, 1, 7, 4, 1, 4, 1, 4, 1, 4, 4, 6, 1, 0, 7, 4, 7, 5,\n",
       "       7, 5, 1, 7, 1, 4, 1, 5, 1, 4, 7, 6, 6, 6, 7, 6, 7, 5, 6, 4, 7, 4,\n",
       "       1, 4, 7, 5, 6, 4, 6, 4, 6, 5, 6, 4, 6, 4, 1, 0, 6, 4, 1, 6, 6, 1,\n",
       "       4, 6, 6, 5, 1, 5, 1, 5, 6, 5, 7, 4, 6, 0, 7, 5, 7, 6, 6, 4, 7, 0,\n",
       "       6, 5, 1, 5, 4, 4, 7, 6, 1, 1, 7, 1, 1, 4, 7, 4, 1, 5, 7, 4, 1, 1,\n",
       "       1, 5, 1, 4, 7, 4, 1, 5, 1, 1, 7, 6, 7, 6, 5, 1, 1, 6, 6, 4, 1, 4,\n",
       "       6, 1, 6, 4, 1, 6, 4, 6, 6, 6, 6, 4, 6, 4, 1, 6, 1, 5, 6, 1, 7, 6,\n",
       "       1, 4, 1, 6, 6, 5, 1, 5, 1, 4, 6, 4, 6, 0, 7, 5, 4, 6, 6, 1, 6, 5,\n",
       "       1, 5, 1, 6, 1, 4, 6, 4, 1, 1, 1, 4, 6, 1, 4, 6, 6, 4, 1, 6, 4, 6,\n",
       "       5, 2, 5, 2, 8, 5, 0, 8, 5, 8, 0, 2, 0, 2, 4, 2, 4, 2, 0, 8, 2, 0,\n",
       "       5, 0, 0, 8, 4, 2, 5, 2, 8, 0, 0, 2, 8, 8, 0, 8, 5, 8, 4, 2, 5, 0,\n",
       "       2, 0, 4, 8, 8, 8, 0, 8, 5, 0, 0, 0, 5, 0, 5, 2, 4, 8, 5, 2, 0, 2,\n",
       "       0, 2, 0, 2, 0, 0, 8, 8, 0, 2, 5, 2, 0, 2, 0, 8, 0, 8, 0, 2, 5, 8,\n",
       "       0, 2, 0, 8, 0, 2, 0, 8, 0, 0, 0, 8, 0, 2, 0, 8, 0, 8, 0, 8, 5, 8,\n",
       "       0, 2, 0, 8, 5, 2, 0, 2, 0, 3, 0, 2, 8, 8], dtype=int32)"
      ]
     },
     "execution_count": 223,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kmeans_algo.labels_"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Plot the data with colours for each cluster (in two dimensions)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "**Finding the right $k$ with the elbow method**"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Let us find the most appropriate value for $k$ using the \"elbow\" method. It consists in plotting, for multiple values of $k$, the global clustering score. While in theory the score can be anything you want, for today let us use the _distortion_. For a cluster $C$ with centroid $c$ and points $(x^{c}_i)_{i=0}$, its distortion $d(c)$ is the sum of the squared distances between the points and the centroid:\n",
    "\n",
    "$$\n",
    "    d(c) = \\sum_i |x_i - c|^2,\n",
    "$$\n",
    "\n",
    "and the distortion of our $k$ clusters is the sum of distortions for each cluster. You can fill the list `elbow_scores` with the scores you will have computed."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAYIAAAERCAYAAAB2CKBkAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nO3deXSc9X3v8fd3Rput1ZZGeN8lgdkMcQCvUsMSIGlo2t5TaJs0aVMCIcROctubpm2Stv+057aQhPSGQwMlCQQuYQmQEBJuwRspBNnYYDC2hcG28CYv8i5rme/9Yx7ZQsjWyNbjZ5bP65znzMzzPJr52gf80W+Z38/cHRERyV+xqAsQEZFoKQhERPKcgkBEJM8pCERE8pyCQEQkzykIRETyXFYGgZndZ2a7zGxtGvdOMrMXzOxVM3vNzK4/GzWKiGSLrAwC4H7g2jTv/TvgEXe/BLgR+D9hFSUiko2yMgjcfRmwt+85M5tuZs+a2UozW25m5/beDlQEzyuBbWexVBGRjFcQdQHD6B7gFnffaGaXk/rN/yPAt4Bfm9ntQClwVXQliohknpwIAjMrA+YCPzWz3tPFweNNwP3u/m9mNgf4sZld4O7JCEoVEck4OREEpLq42t191gDX/oJgPMHd/9vMSoAaYNdZrE9EJGNl5RhBf+5+AHjHzP4HgKVcHFzeAlwZnD8PKAHaIilURCQDWTauPmpmDwFNpH6z3wl8E3ge+D4wFigEHnb3fzSzmcB/AGWkBo7/2t1/HUXdIiKZKCuDQEREhk9OdA2JiMjpy7rB4pqaGp8yZUrUZYiIZJWVK1fudvfEQNeyLgimTJlCc3Nz1GWIiGQVM9t8smvqGhIRyXMKAhGRPKcgEBHJcwoCEZE8pyAQEclzCgIRkTynIBARyXN5EwQbdh7kn37+Jh1dPVGXIiKSUfImCFr3HeHeFe/wyrt7B79ZRCSPhBYEZjYx2DR+nZm9YWaLBrinycz2m9nq4PhGWPXMmVZDUUGMpeu1ArWISF9hLjHRDXzV3VeZWTmw0syec/c3+9233N0/HmIdAIwoinP51NEs2dDG34X9YSIiWSS0FoG7b3f3VcHzg8A6YHxYn5eOxvoELbsO0brvSJRliIhklLMyRmBmU4BLgJcHuDzHzNaY2S/N7PyT/PzNZtZsZs1tbafftdPUUAvA0g3qHhIR6RV6EAQbyz8GLA62lOxrFTDZ3S8G7gJ+NtB7uPs97j7b3WcnEgOuopqW6YlSJowawRKNE4iIHBdqEJhZIakQeNDdH+9/3d0PuPuh4PkzQKGZ1YRYD431CX7TspvO7mRYHyMiklXCnDVkwL3AOne/4yT3jAnuw8wuC+rZE1ZNkOoeOtzZQ/NmTSMVEYFwZw3NAz4FvG5mq4NzXwcmAbj73cAfAreaWTdwFLjRQ95Eee70agrjxtL1bcydHlrjQ0Qka4QWBO6+ArBB7vke8L2wahhIaXEBH54ymiXr2/ib6887mx8tIpKR8uabxX01NSRYv/Mg2/cfjboUEZHI5WkQBNNINXtIRCQ/g6CutoyxlSWaRioiQp4GgZnR1JDgxZbddPVoGqmI5Le8DAKAxvpaDh7rZtXmfVGXIiISqbwNgnkzqimIGUu03ISI5Lm8DYLykkI+NHmUBoxFJO/lbRBAavbQm9sPsOtAR9SliIhEJq+DoLE+tYCduodEJJ/ldRCcN7ac2vJiLUstInktr4OgdzXS5Rva6NY0UhHJU3kdBJAaJzjQ0c3qre1RlyIiEom8D4L5dTXEY6buIRHJW3kfBJUjCrlkYpWWmxCRvJX3QQCp1Uhff28/bQePRV2KiMhZpyDgxGqkyzeqVSAi+UdBAMwcW0FNWZG6h0QkLykIgFjMWFifYNnGNnqSoe6UKSKScRQEgaaGWtqPdPFaq6aRikh+URAEFsyoIWaoe0hE8o6CIDCqtIiLJ1Zp3SERyTsKgj6a6mt5rbWdvYc7oy5FROSsURD00diQwF3TSEUkvygI+rhofCWjSzWNVETyi4Kgj1jMWFhXw7INbSQ1jVRE8oSCoJ/GhgR7Dneydtv+qEsRETkrFAT9LKxLYIb2MhaRvKEg6Ke6rJiLxldqGqmI5A0FwQAa6xO8umUf7Uc0jVREcp+CYACNDbUkHVa07I66FBGR0IUWBGY20cxeMLN1ZvaGmS0a4B4zs++aWYuZvWZml4ZVz1DMmlhF5YhCTSMVkbxQEOJ7dwNfdfdVZlYOrDSz59z9zT73XAfUBcflwPeDx0jFY8aCuhqWBtNIYzGLuiQRkdCE1iJw9+3uvip4fhBYB4zvd9sNwI885SWgyszGhlXTUDQ11NJ28BjrdhyIuhQRkVCdlTECM5sCXAK83O/SeGBrn9etfDAsMLObzazZzJrb2s5Od83C+hpAq5GKSO4LPQjMrAx4DFjs7v1/vR6oz+UDX+l193vcfba7z04kEmGU+QG15SWcP65C3ycQkZwXahCYWSGpEHjQ3R8f4JZWYGKf1xOAbWHWNBRNDQlWbtnHgY6uqEsREQlNmLOGDLgXWOfud5zktqeATwezh64A9rv79rBqGqqmhlp6ks6LGzWNVERyV5izhuYBnwJeN7PVwbmvA5MA3P1u4BngeqAFOAJ8NsR6huySiVWUlxSwZH0b112YEWPYIiLDLrQgcPcVDDwG0PceB24Lq4YzVRCPHZ9G6u6kGjkiIrlF3yweRGN9gh0HOli/82DUpYiIhEJBMIjG+lpA00hFJHcpCAYxprKEc8eUaxqpiOQsBUEaGhsSNG/ey6Fj3VGXIiIy7BQEaWiqr6Wrx3lRq5GKSA5SEKThQ5NHUVZcwFJtViMiOUhBkIaighhzp1ezdH1qGqmISC5REKSpqaGW99qP0rLrUNSliIgMKwVBmhobUovdqXtIRHKNgiBN46tGUFdbpu8TiEjOURAMQVNDgt++s5fDmkYqIjlEQTAETQ21dPYkeWnTnqhLEREZNgqCIZg9ZRQji+LqHhKRnKIgGILigjhzp1ezZMMuTSMVkZyhIBiixoZatu49yju7D0ddiojIsFAQDFFTfWoaqbqHRCRXKAiGaOLokUxLlLJE3ycQkRyhIDgNTfW1vLxpDx1dPVGXIiJyxhQEp6GxIcGx7iT/rWmkIpIDFASn4fKpoykpjGmzGhHJCQqC01BSGGfOtGqtOyQiOUFBcJoa6xO8s/swm/doGqmIZDcFwWlqatCm9iKSGxQEp2lKTSlTqkeqe0hEsp6C4Aw01if4zdu7NY1URLKaguAMNDXU0tGV5JV390ZdiojIaVMQnIErplVTVBDTOIGIZDUFwRkYURTn8qmjWbJ+V9SliIictrSDwMziZjbOzCb1HmEWli2aGmp5u+0wW/ceiboUEZHTklYQmNntwE7gOeAXwfHzEOvKGo312tReRLJbui2CRUCDu5/v7hcGx0VhFpYtpidKmTBqhMYJRCRrpRsEW4H9Q3ljM7vPzHaZ2dqTXG8ys/1mtjo4vjGU988UZkZTQ2oaaWd3MupyRESGrCDN+zYBS8zsF8Cx3pPufscpfuZ+4HvAj05xz3J3/3iaNWSsxvpaHnhpC83v7mXujJqoyxERGZJ0WwRbSI0PFAHlfY6TcvdlQF5MsJ87vZqieEyb1YhIVkqrReDu/wBgZuWpl35omD5/jpmtAbYB/9Pd3xjoJjO7GbgZYNKkzJusVFpcwIenjmLp+ja+fv15UZcjIjIk6c4ausDMXgXWAm+Y2UozO/8MP3sVMNndLwbuAn52shvd/R53n+3usxOJxBl+bDga6xOs33mQbe1Hoy5FRGRI0u0augf4irtPdvfJwFeB/ziTD3b3A70tC3d/Big0s6ztYO9djVTTSEUk26QbBKXu/kLvC3dfApSeyQeb2Rgzs+D5ZUEtWbv3Y11tGeMqS7RrmYhknbRnDZnZ3wM/Dl7/KfDOqX7AzB4CmoAaM2sFvgkUArj73cAfAreaWTdwFLjR3X3If4IMYWY0NiT4+ZrtdPUkKYxr9Q4RyQ7pBsGfA/8APA4YsAz47Kl+wN1vGuT690hNL80ZjfW1PPTbrazcvI8rplVHXY6ISFrSnTW0D/hSyLVkvXkzqimIGUs3tCkIRCRrnLL/wsy+HTw+bWZP9T/OTonZo7ykkA9NHqXlJkQkqwzWIugdE/jXsAvJFU0NtfzLs2+x80AH51SURF2OiMigTtkicPeVwdNZ7r607wHMCr+87NPUoNVIRSS7pDu15c8GOPeZYawjZ5w7ppxzKoo1jVREssYpu4bM7Cbgj4Fp/cYEysniOf9hMjMa6xM8u3YH3T1JCjSNVEQy3GBjBL8BtgM1wL/1OX8QeC2sorJdU0MtjzS3snprO7OnjI66HBGRUzplELj75uDLYIeDcQFJw7wZNcRjxpL1bQoCEcl4g/ZbuHsPcMTMKs9CPTmhckQhl06qYskGbWovIpkv3W8WdwCvm9lzwOHek+6uL5mdRFNDLf/7V+tpO3iMRHlx1OWIiJxUuiOZvwD+ntTSEiv7HHISvZvaL9M0UhHJcOkuMfFDMysC6oNT6929K7yyst/MsRXUlBWzZEMbf/ChCVGXIyJyUmkFgZk1AT8E3iW16NxEM/uzYDtKGUAslppG+l9v7aQn6cRjFnVJIiIDSrdr6N+Aa9y90d0XAh8F7gyvrNzQ2JCg/UgXa1rboy5FROSk0g2CQndf3/vC3TcQ7C0gJ7ewroaYoUXoRCSjpRsEzWZ2r5k1Bcd/oMHiQVWNLGLWxCqtOyQiGS3dILgVeIPUngSLgDeBz4dVVC5prK/ltdZ29hw6FnUpIiIDSjcIbnH3O9z99939k+5+J6lwkEE0NSRwh+Ubd0ddiojIgLT6aMguHF/J6NIidQ+JSMZKd/XRqf1WH61Aq4+mJRYzFtbVsGxDG8mkE9M0UhHJMFp99CxoaqjlZ6u3sXbbfi6aUBV1OSIi7zPYDmWb3X0JcBWwPFiBdDswgdQXyyQNC+pqME0jFZEMle4YwTKgxMzGA/8FfBa4P6yick11WTEXja9kyXqtRioimSfdIDB3PwL8PnCXu38SmBleWbmnsaGW1VvbaT/SGXUpIiLvk3YQmNkc4E9IrUQK6S9hLaRWI01qGqmIZKB0g2Ax8DfAE+7+hplNA14Ir6zcM2tiFVUjCzVOICIZJ91lqJcCS/u83kTqW8aSpnjMWFCXYKmmkYpIhhnsewTfdvfFZvY04P2vu/snQqssBzXWJ3h6zTbe3H6AC8Zr508RyQyDtQh+HDz+a9iF5IPeXcuWbmhTEIhIxjhlELj7yuBxqZklgufq5D5NifJiLhhfwdL1bdz2OzOiLkdEBBhksNhSvmVmu4G3gA1m1mZm3xjsjc3sPjPbZWZrT/He3zWzFjN7zcwuPb0/QnZprE+wcss+9h/VTp8ikhkGmzW0GJgHfNjdq919FHA5MM/MvjzIz94PXHuK69cBdcFxM/D9tCrOck0NtfQknRdbNI1URDLDYEHwaeAmd3+n90QwY+hPg2snFexnvPcUt9wA/MhTXgKqzGxsemVnr0smVlFeUsBSTSMVkQwxWBAUuvsHfnUNxgnOdKvK8cDWPq9bg3M5rSAeY0FdDUs3tOH+gYlYIiJn3WBBcKr1EM50rYSBJtIP+C+jmd1sZs1m1tzWlv2/STfV17LjQAdv7TgYdSkiIoMGwcVmdmCA4yBw4Rl+diswsc/rCcC2gW5093vcfba7z04kEmf4sdFrbDgxjVREJGqDLUMdd/eKAY5ydz/TrqGngE8Hs4euAPa7+/YzfM+scE5FCeeOKddqpCKSEUJbOM7MHgKagBozawW+STCu4O53A88A1wMtwBFSS1vnjaaGWn6wfBMHO7ooLznTTBUROX2hBYG73zTIdQduC+vzM11TQ4K7l77Nb97ew0fPHxN1OSKSx9JdfVSG2Ycmj6KsuECrkYpI5BQEESmMx5g3o5ql63dpGqmIREpBEKGmhlq27e+gZdehqEsRkTymIIhQ72qk6h4SkSgpCCI0rmoE9eeUsWSDppGKSHQUBBFraqjllXf2sf+IViMVkWgoCCJ2/YVj6Uom+dhdy7UiqYhEQkEQsVkTq/jp5+dQGI/xJz94ma8/8ToHO9Q6EJGzR0GQAWZPGc0vFy3gLxdM5aHfbuHaby9n+UYNIIvI2aEgyBAlhXH+9mMzefSWuZQUxvjUvb/la4+9xgG1DkQkZAqCDPOhyaP4xZcWcEvjdB5p3spH71ymxelEJFQKggxUUhjna9edy+NfmEdZcQGf+c9X+KufrtE+xyISCgVBBps1sYqnb5/PF5qm8/ir73HNnUt5/q2dUZclIjlGQZDhSgrj/PW15/LEF+ZSNaKIP7+/ma88slrfOxCRYaMgyBIXTajiqdvn8aWPzODJ1du4+s6lPPemWgcicuYUBFmkuCDOV65p4Mnb5jG6tIi//FEzix9+lX2Hz3T7aBHJZwqCLHTB+Eqe+uJ8Fl9Vx89f287Vdy7j2bU7oi5LRLKUgiBLFRXEWHxVPU99cT615cXc8sBKbn/oVfaqdSAiQ6QgyHIzx1Xw5Bfn8dWr63l27XauvmMpz7y+PeqyRCSLKAhyQGE8xu1X1vH07fMZVzWCLzy4itseXMXuQ8eiLk1EsoCCIIecO6aCJ74wl7/6aAPPvbmTa+5cxtNrtmkrTBE5JQVBjimIx7jtd2bw8y/NZ+KoEdz+0Kvc+sAq2g6qdSAiA1MQ5Kj6c8p57Na5fO26c3l+/S6uvnMpT65+T60DEfkABUEOK4jHuKVxOs98aT5Ta0pZ9PBqbv7xSnYd6Ii6NBHJIAqCPDCjtpxHb5nL315/Hss2tHH1nct4fFWrWgciAigI8kY8Zvzlwmk8s2gBM2rL+Moja/jcD5vZqdaBSN5TEOSZ6YkyHvn8HP7+4zN58e3dXH3HUn7avFWtA5E8piDIQ/GY8Rfzp/LsooWcO6aCv3r0NT57/yts33806tJEJAIKgjw2paaUh2++gm/97kxe3rSXa+5Yxv99ZYtaByJ5RkGQ52Ix4zPzpvLs4gWcP76C//XY63z6vt/yXrtaByL5QkEgAEyuLuUnn7uCf7rhfFZu3sdH71zGgy9vJplU60Ak14UaBGZ2rZmtN7MWM/vaANebzGy/ma0Ojm+EWY+cWixmfGrOFH61eCEXTajkb59Yy7XfWcYvXtuuQBDJYaEFgZnFgX8HrgNmAjeZ2cwBbl3u7rOC4x/DqkfSN3H0SB783OV896ZL6Ek6t/1klQJBJIeF2SK4DGhx903u3gk8DNwQ4ufJMDIzPnHxOH795Ua+c+Os44Fw3XeW88zrCgSRXBJmEIwHtvZ53Rqc62+Oma0xs1+a2fkDvZGZ3WxmzWbW3NbWFkatchLxmHHDrPHHA6ErmeQLD67i+u8u55cKBJGcEGYQ2ADn+v+rsQqY7O4XA3cBPxvojdz9Hnef7e6zE4nEMJcp6egNhOe+3Mi3/2gWnd1Jbg0C4dm1CgSRbBZmELQCE/u8ngBs63uDux9w90PB82eAQjOrCbEmOUPxmPF7l4znua+cCIRbHljFx+5awbNrdygQRLJQmEHwClBnZlPNrAi4EXiq7w1mNsbMLHh+WVDPnhBrkmHSGwi//vJC7vyji+no6uGWB1YeDwR9KU0kexSE9cbu3m1mXwR+BcSB+9z9DTO7Jbh+N/CHwK1m1g0cBW50/QuSVQriMT55yQR+96JxPLVmG3c938ItD6xk5tgKFl1VxzUzzyHIehHJUJZt/+7Onj3bm5uboy5DTqK7J8mTq7dx1/MbeXfPEWaOrWDxVXVcrUAQiZSZrXT32QNeUxBIGPoHwvnjKlh8VT1XnVerQBCJgIJAItPdk+RnQSBsViCIREZBIJHr7knyxKvvcdfzLWzZe4QLxlew+Mp6rlQgiJwVCgLJGF1BIHwvCIQLx1ey+Ko6PnKuAkEkTAoCyThdPUmeWPUed72wka17j3LRhFQg/E6DAkEkDAoCyVj9A+HiCZUsvqqepoaEAkFkGCkIJON19SR5fFUrdz3fQus+BYLIcFMQSNbo7D4RCO+1H+XiiVUsvqqOpnoFgsiZUBBI1unsTvLYqla+FwTCrCAQGhUIIqdFQSBZq7M7yaMrW/n3F1KBcMmkKhZdWceCugTxmAJBJF0KAsl6/QOhamQhc6dXM39GgvkzaphUPTLqEkUymoJAckZnd5Jn39jBsg1trNi4mx0HOgCYNHok82bUsKCuhrnTq6kaWRRxpSKZRUEgOcndebvtMC+27Gb5xt28tGkPh451YwYXjq9MBcOMGi6dPIqSwnjU5YpESkEgeaG7J8ma1nZWbNzDipY2Xt3STnfSKSmM8eEpo5k/o4b5dTWcN6aCmMYXJM8oCCQvHTrWzcub9rCiZTcrNu5m465DAFSXFjF3Rg3zZ1Qzvy7B+KoREVcqEr5TBUFoG9OIRK2suIArzzuHK887B4CdBzpYsXE3L7bsZkXLbp5ek9o5dWpNKfNn1DBvRg1zpldTOaIwyrJFzjq1CCQvuTsbdx1ixcZUKLy0aQ9HOnuIGVw0oYoFdalguHTSKIoKwtzRVeTsUNeQyCA6u5Os3toedCO1saZ1Pz1JZ0RhnMunnRhfaDinXF9ok6ykIBAZogMdXbz09p7UjKSW3WxqOwxATVnx8bGF+TNqGFNZEnGlIunRGIHIEFWUFHLN+WO45vwxAGxrP8qKlhPjCz9bnRpfmFFbdnx84Yppoykv0fiCZB+1CESGKJl01u88ePz7Cy+/s4eOriQxg3MqShhTWcK4yhGMqSxhbGUJ46pGHD+XKC/W0hgSCXUNiYToWHcPqza38/I7e9i69yg7Dhxle3sH2/YfpaMr+b574zHjnPLiVEhUjWBsRfBYWaKwkFCpa0gkRMUFceZMr2bO9Or3nXd39h/tYvv+DrbvP5p6bO84/nrdtgP817qdQwqL1KGwkOGlIBAJiZlRNbKIqpFFnDe2YsB7esNiW3sHOw4cTT3uT7Umduzv4M1tB/h/b+7kWPfAYTH2eLdTCWMqRwSPqe6omjKFhaRHQSASob5hMXPcycOi/Ui/lkWfFsbJwqIgZsfHLCpKCigrKaSsOE5pUQGlxQWUFaceS4vjx5+X9TlfVlxASWFM02XzgIJAJMOZGaNKixhVOnhY9LYktu3vYMf+o8e7otoOHePdPUc4dKybw8e6OdLZk9Znx4x+oVFwPEzKSt4fGqVF8QHuTQVNeXEhpcVxCuL6cl4mUhCI5IC+YXH+uMpB7+9JOkc6u48Hw6FjPcFj6nX/cyfuSz3uPtiZet7ZzaGObrqT6U06KS6IvS8oyotTgdIbGuV9wqX3Wlnfx977iwrU7TWMFAQieSgeM8pLCoflew/uzrHuZBAgPScCol+oHOoY6Hw3uw52cKjtROD0Hzw/mZFF8ePBUN63a6tfaPS/1ts66X2u7i8FgYicITOjpDBOSWGc6rIzf7+unlSoHOw40eI42BscHamwONhxIkgOBucPH+tmy+EjHOw4ESo9abRU4jGjtChOeUnh8a6sksI4hfEYhfEYxQUxCuOWel0Qoyieel1UEDt+z4lz8Q9eC36+KN73nFEUj1NYYO97j6KCWCQtHQWBiGSUwnjs+AD6mehtqfQGQ2+4pEKi63gr5dCxruCxJzjfTWfQwunscbp6kqmjO0lnT5LO7iRdwfl0u8SGImacCJfe4AkC448vm8TnFkwb9s9UEIhITurbUkmUF4fyGcmk09kbFEE4pIIiFRpd3X2v973mdHWfOH+sT7j0/mzvvV3dfvxcWH+OUIPAzK4FvgPEgR+4+z/3u27B9euBI8Bn3H1VmDWJiAyXWMwoicWzfivU0OZymVkc+HfgOmAmcJOZzex323VAXXDcDHw/rHpERGRgYU7qvQxocfdN7t4JPAzc0O+eG4AfecpLQJWZjQ2xJhER6SfMIBgPbO3zujU4N9R7MLObzazZzJrb2tqGvVARkXwWZhAMNAeq/xB7Ovfg7ve4+2x3n51IJIalOBERSQkzCFqBiX1eTwC2ncY9IiISojCD4BWgzsymmlkRcCPwVL97ngI+bSlXAPvdfXuINYmISD+hTR91924z+yLwK1LTR+9z9zfM7Jbg+t3AM6SmjraQmj762bDqERGRgYX6PQJ3f4bUP/Z9z93d57kDt4VZg4iInFrWbVVpZm3A5tP88Rpg9zCWM1wytS7I3NpU19CorqHJxbomu/uAs22yLgjOhJk1n2zPzihlal2QubWprqFRXUOTb3VplwgRkTynIBARyXP5FgT3RF3ASWRqXZC5tamuoVFdQ5NXdeXVGIGIiHxQvrUIRESkHwWBiEiey4sgMLP7zGyXma2Nupa+zGyimb1gZuvM7A0zWxR1TQBmVmJmvzWzNUFd/xB1TX2ZWdzMXjWzn0ddSy8ze9fMXjez1WbWHHU9vcysysweNbO3gv/O5mRATQ3B31PvccDMFkddF4CZfTn4b36tmT1kZiVR1wRgZouCmt4I4+8qL8YIzGwhcIjU3gcXRF1Pr2DvhbHuvsrMyoGVwO+5+5sR12VAqbsfMrNCYAWwKNgzInJm9hVgNlDh7h+Puh5IBQEw290z6ktIZvZDYLm7/yBY82uku7dHXVevYAOr94DL3f10vyg6XLWMJ/Xf+kx3P2pmjwDPuPv9Edd1Aan9XC4DOoFngVvdfeNwfUZetAjcfRmwN+o6+nP37b1bc7r7QWAdA+zHcLYFGwUdCl4WBkdG/MZgZhOAjwE/iLqWTGdmFcBC4F4Ad+/MpBAIXAm8HXUI9FEAjDCzAmAkmbEa8nnAS+5+xN27gaXAJ4fzA/IiCLKBmU0BLgFejraSlKD7ZTWwC3jO3TOiLuDbwF8DyagL6ceBX5vZSjO7OepiAtOANuA/g660H5hZadRF9XMj8FDURQC4+3vAvwJbgO2kVkP+dbRVAbAWWGhm1WY2ktRCnRMH+ZkhURBkADMrAx4DFrv7gajrAXD3HnefRWqPiMuC5mmkzOzjwC53Xxl1LQOY5+6XktqH+7agOzJqBcClwPfd/RLgMPC1aEs6Ieiq+gTw06hrATCzUaS2z50KjANKzexPo60K3H0d8C/Ac6S6hdYA3cP5GQqCiAV98BqjxfIAAAIgSURBVI8BD7r741HX01/QlbAEuDbiUgDmAZ8I+uMfBj5iZg9EW1KKu28LHncBT5Dqz41aK9DapzX3KKlgyBTXAavcfWfUhQSuAt5x9zZ37wIeB+ZGXBMA7n6vu1/q7gtJdXMP2/gAKAgiFQzK3gusc/c7oq6nl5klzKwqeD6C1P8gb0VbFbj737j7BHefQqpL4Xl3j/w3NjMrDQb7CbperiHVnI+Uu+8AtppZQ3DqSiDSiQj93ESGdAsFtgBXmNnI4P/NK0mN20XOzGqDx0nA7zPMf2+h7keQKczsIaAJqDGzVuCb7n5vtFUBqd9wPwW8HvTHA3w92MchSmOBHwYzOmLAI+6eMVM1M9A5wBOpfzsoAH7i7s9GW9JxtwMPBt0wm8iQzZ+Cvu6rgc9HXUsvd3/ZzB4FVpHqenmVzFlq4jEzqwa6gNvcfd9wvnleTB8VEZGTU9eQiEieUxCIiOQ5BYGISJ5TEIiI5DkFgYhInlMQiAwDM5uSaavbiqRLQSAikucUBCLDzMymBYu8fTjqWkTSoSAQGUbBcg6PAZ9191eirkckHXmxxITIWZIAngT+wN3fiLoYkXSpRSAyfPYDW0mtISWSNdQiEBk+ncDvAb8ys0Pu/pOoCxJJh4JAZBi5++FgA53nzOywuz8ZdU0ig9HqoyIieU5jBCIieU5BICKS5xQEIiJ5TkEgIpLnFAQiInlOQSAikucUBCIiee7/A3+FOIwoKBHaAAAAAElFTkSuQmCC\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "def distortion(data, clustering):\n",
    "    distortion = 0.0\n",
    "    # Write code here\n",
    "    \n",
    "    return distortion\n",
    "\n",
    "min_k = 1\n",
    "max_k = 10\n",
    "elbow_scores = []\n",
    "\n",
    "# Write code here\n",
    "\n",
    "plt.plot(list(range(min_k, max_k)), elbow_scores)\n",
    "plt.xlabel(\"k\")\n",
    "plt.ylabel(\"Distortion\");"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Classification\n",
    "\n",
    "While we have not seen any classification algorithms in class yet, let us try to classify (instead of cluster) our data. The code for the classification algorithm is already completely written out for you, so you can focus on the other tasks.\n",
    "\n",
    "Start by choosing what you want to classify on (for example, the species). You can use the exploratory data analysis you did before to guide your choice."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 222,
   "metadata": {},
   "outputs": [],
   "source": [
    "def train_test_split(data: pd.DataFrame, target_key:str, percent_test: int =15):\n",
    "    # Write code here\n",
    "    \n",
    "    return X_train, y_train, X_test, y_test\n",
    "\n",
    "X_train, y_train, X_test, y_test = train_test_split(data, target_key=\"species\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Check that your train and test set are appropriate. For example, is the repartition of the target variable similar? If not, how could you correct this issue?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 216,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([1, 2, 1, 0, 2, 2, 2, 0, 0, 2, 1, 2, 0, 1, 1, 0, 0, 0, 1, 0, 1, 2,\n",
       "       0, 0, 1, 1, 2, 0, 2, 2, 2, 1, 2, 0, 0, 0, 0, 0, 2, 0, 0, 2, 0, 0,\n",
       "       1, 2, 2, 2, 1, 0, 2, 0, 2, 0, 0, 0, 2, 2, 0, 0, 1, 1, 2, 0, 0, 0,\n",
       "       0, 2, 0, 1, 0, 2, 0, 0, 1, 0, 2, 0, 1, 0, 0, 0, 1, 0, 2, 0, 0, 0,\n",
       "       2, 2, 1, 0, 1, 1, 0, 2, 0, 0, 0, 2, 0, 1, 0, 0, 2, 1, 0, 0, 0, 1,\n",
       "       0, 2, 1, 2, 0, 1, 0, 2, 0, 2, 0, 2, 0, 1, 0, 0, 0, 2, 0, 1, 2, 2,\n",
       "       0, 0, 2, 0, 1, 2, 0, 2, 0, 0, 2, 0, 1, 2, 0, 2, 0, 1, 2, 0, 2, 1,\n",
       "       1, 2, 1, 2, 2, 1, 0, 2, 2, 2, 2, 2, 2, 2, 0, 1, 0, 0, 0, 2, 2, 0,\n",
       "       2, 2, 2, 0, 0, 0, 1, 2, 1, 0, 0, 0, 0, 0, 2, 0, 0, 1, 0, 2, 1, 0,\n",
       "       2, 2, 2, 0, 2, 2, 0, 0, 0, 0, 0, 0, 1, 2, 2, 0, 1, 2, 2, 1, 2, 2,\n",
       "       2, 2, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 2, 0, 0, 0, 2, 2, 2, 0,\n",
       "       0, 0, 0, 2, 0, 2, 1, 2, 1, 0, 0, 1, 0, 0, 1, 2, 1, 0, 1, 0, 0, 0,\n",
       "       0, 0, 1, 1, 2, 1, 1, 1, 2, 0, 2, 2, 2, 2, 2, 2, 2, 2, 0, 2, 2, 1,\n",
       "       2, 0, 2, 0, 0, 0, 1])"
      ]
     },
     "execution_count": 216,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Simple random forest code\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "\n",
    "rf = RandomForestClassifier(n_estimators=50)\n",
    "rf.fit(X_train, y_train)\n",
    "rf.predict(X_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Evaluation\n",
    "\n",
    "Now it is time to focus on the evaluation of our models. Let us use this as an opportunity to compare the clustering and classification approaches.\n",
    "\n",
    "   - How can we evaluate the quality of the clustering? Think about the ranking agreement metrics we saw in the first lecture\n",
    "   - Can we look at the confusion matrix outputted by our classification algorithm?\n",
    "   - How can we evaluate the quality of the classification? You can go read again about the F1-score and ROC curves"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Implementing DBScan\n",
    "\n",
    "For the last part of the lab, let us focus a little bit on implementation. Your goal is to reimplement a functional version of the [DBScan algorithm]() that we saw during the lecture. You will find below a skeleton of code that you can fill in.\n",
    "\n",
    "Once you have a functional version (if you still have time), you can try to make your implementation faster, by thinking about the following questions:\n",
    "\n",
    "   - Can the neighbourhood lookup be faster?\n",
    "   - Can the $\\mu$ parameter be implemented easily?\n",
    "   - How can the scalability of the algorithm be tested?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 104,
   "metadata": {},
   "outputs": [],
   "source": [
    "def dbscan(data: pd.DataFrame, epsilon: float, mu:int =1):\n",
    "    clusters = [] # This list will contain the cluster number for each data point\n",
    "    \n",
    "    \n",
    "    return clusters"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
